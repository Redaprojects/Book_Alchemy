<h1>My Library</h1>
{% with messages = get_flashed_messages() %}
  {% if messages %}
    <ul class="flashes">
      {% for message in messages %}
        <li>{{ message }}</li>
      {% endfor %}
    </ul>
  {% endif %}
{% endwith %}

<form method="get" action="{{ url_for('home') }}">
    <input type="text" name="search" placeholder="Search by title or author..." value="{{ request.args.get('search', '') }}" required>
    <button type="submit">Search</button>
</form>

<a href="{{ url_for('add_author') }}">Add Author</a> |
<a href="{{ url_for('add_book') }}">Add Book</a>

<form method="get" action="{{ url_for('home') }}">
    Sort by:
    <select name="sort" onchange="this.form.submit()">
        <option value="title" {% if sort=='title' %}selected {% endif %}>Title</option>
        <option value="author" {% if sort=='author' %}selected{% endif %}>Author</option>
    </select>
</form>


<ul>
    {% for book in books %}
      <li>
        {% if book.cover_url %}
          <img src="{{ book.cover_url }}" alt="Cover" style="height:100px;">
        {% endif %}
        <strong>{{ book.title }}</strong> by {{ book.author.name }} ({{ book.publication_year }})

          <!-- Delete button form -->
        <form action="{{ url_for('delete_book', book_id=book.id) }}" method="POST" style="display:inline;">
            <button type="submit" onclick="return confirm('Are you sure you want to delete this book?')">Delete</button>
        </form>
      </li>
    {% endfor %}
</ul>
